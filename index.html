<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Text Detector & Converter</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --secondary: #10b981;
            --danger: #ef4444;
            --warning: #f59e0b;
            --light: #f8fafc;
            --dark: #1e293b;
            --gray: #64748b;
            --gray-light: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: var(--dark);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            min-height: 90vh;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
            color: white;
            padding: 40px 50px;
            position: relative;
            overflow: hidden;
        }

        .header-content {
            position: relative;
            z-index: 2;
        }

        h1 {
            font-size: 3.2rem;
            font-weight: 800;
            margin-bottom: 10px;
            background: linear-gradient(45deg, #fff, #d1d5db);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            letter-spacing: -0.5px;
        }

        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 25px;
            font-weight: 300;
        }

        .stats-bar {
            display: flex;
            gap: 30px;
            margin-top: 30px;
        }

        .stat-item {
            text-align: center;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-value {
            font-size: 2.2rem;
            font-weight: 800;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Main Content */
        .main-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            padding: 40px;
        }

        @media (max-width: 1100px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: var(--light);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            border: 1px solid var(--gray-light);
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--gray-light);
        }

        .card-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .card-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--dark);
        }

        /* File Upload Section - MODIFIED */
        .file-upload-container {
            margin-bottom: 25px;
        }

        .upload-area {
            border: 2px dashed var(--primary);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            background: rgba(99, 102, 241, 0.05);
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            background: rgba(99, 102, 241, 0.1);
            border-color: var(--primary-dark);
        }

        .upload-area.drag-over {
            background: rgba(99, 102, 241, 0.15);
            border-color: var(--secondary);
            transform: translateY(-2px);
        }

        .upload-icon {
            font-size: 3rem;
            color: var(--primary);
            margin-bottom: 15px;
        }

        .upload-text {
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--dark);
        }

        .upload-subtext {
            color: var(--gray);
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .file-input-hidden {
            display: none;
        }

        .selected-file {
            background: white;
            border-radius: 12px;
            padding: 15px 20px;
            border: 2px solid var(--gray-light);
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-top: 15px;
            animation: fadeIn 0.3s ease;
        }

        .file-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .file-icon {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .file-details {
            flex: 1;
        }

        .file-name {
            font-weight: 600;
            margin-bottom: 4px;
            word-break: break-all;
        }

        .file-size {
            font-size: 0.85rem;
            color: var(--gray);
        }

        .file-actions {
            display: flex;
            gap: 10px;
        }

        .file-action-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        /* REMOVED: file-analyze-btn and file-remove-btn styles since we're removing the search icon */

        /* MODIFIED: Changed to single button that directly analyzes */
        .file-analyze-direct {
            background: var(--primary);
            color: white;
            width: auto;
            padding: 8px 16px;
            border-radius: 8px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .file-analyze-direct:hover {
            background: var(--primary-dark);
            transform: translateY(-2px);
        }

        .file-remove-btn {
            color: var(--danger);
        }

        .file-remove-btn:hover {
            background: rgba(239, 68, 68, 0.1);
        }

        .supported-formats {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 15px;
        }

        .format-badge {
            background: rgba(99, 102, 241, 0.1);
            color: var(--primary);
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        /* Text Area */
        .text-area-container {
            margin-bottom: 25px;
        }

        textarea {
            width: 100%;
            min-height: 200px;
            padding: 20px;
            border: 2px solid var(--gray-light);
            border-radius: 16px;
            font-size: 1rem;
            line-height: 1.6;
            resize: vertical;
            transition: all 0.3s;
            background: white;
        }

        textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(99, 102, 241, 0.1);
        }

        textarea::placeholder {
            color: var(--gray);
        }

        /* Buttons */
        .button-group {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 10px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(99, 102, 241, 0.3);
        }

        .btn-secondary {
            background: linear-gradient(135deg, var(--secondary), #0da271);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger), #dc2626);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.3);
        }

        /* Results Section */
        .results-container {
            margin-top: 30px;
        }

        .prediction-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 6px solid;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
        }

        .prediction-ai {
            border-left-color: var(--danger);
        }

        .prediction-human {
            border-left-color: var(--secondary);
        }

        .prediction-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .prediction-badge {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1.4rem;
            font-weight: 700;
        }

        .prediction-ai .prediction-badge {
            color: var(--danger);
        }

        .prediction-human .prediction-badge {
            color: var(--secondary);
        }

        .confidence {
            font-size: 1.1rem;
            color: var(--gray);
            font-weight: 600;
        }

        /* Progress Bars */
        .progress-container {
            margin: 25px 0;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .progress-bar {
            height: 30px;
            background: var(--gray-light);
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            border-radius: 15px;
            transition: width 1.5s cubic-bezier(0.34, 1.56, 0.64, 1);
            position: relative;
        }

        .progress-ai {
            background: linear-gradient(135deg, #ef4444, #f87171);
        }

        .progress-human {
            background: linear-gradient(135deg, #10b981, #34d399);
        }

        .progress-text {
            position: absolute;
            right: 15px;
            top: 0;
            height: 100%;
            display: flex;
            align-items: center;
            color: white;
            font-weight: 600;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        /* Tabs */
        .tabs {
            display: flex;
            border-bottom: 2px solid var(--gray-light);
            margin: 25px 0;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            font-weight: 500;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            color: var(--gray);
        }

        .tab.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Conversion Controls */
        .conversion-controls {
            background: white;
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
            border: 2px solid var(--gray-light);
        }

        .intensity-control {
            margin: 20px 0;
        }

        .intensity-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-weight: 500;
        }

        .slider-container {
            position: relative;
            height: 30px;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            -webkit-appearance: none;
            background: var(--gray-light);
            border-radius: 4px;
            outline: none;
            position: absolute;
            top: 11px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary);
            cursor: pointer;
            border: 4px solid white;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
        }

        .slider-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 5px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Conversion Results */
        .conversion-results {
            margin-top: 30px;
        }

        .conversion-card {
            background: white;
            border-radius: 16px;
            padding: 25px;
            border: 2px solid var(--primary);
            position: relative;
        }

        .conversion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .conversion-percentage {
            font-size: 2rem;
            font-weight: 800;
            color: var(--primary);
        }

        .conversion-stats {
            display: flex;
            gap: 20px;
            margin: 15px 0;
            padding: 15px;
            background: var(--light);
            border-radius: 12px;
        }

        .stat-box {
            text-align: center;
            flex: 1;
        }

        .stat-value-lg {
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label-sm {
            font-size: 0.9rem;
            color: var(--gray);
        }

        /* Explanation Box */
        .explanation-box {
            background: linear-gradient(135deg, #f0f9ff, #e0f2fe);
            border-radius: 16px;
            padding: 25px;
            margin: 20px 0;
            border-left: 6px solid var(--primary);
        }

        .pattern-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .pattern-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border-left: 4px solid;
        }

        .pattern-ai {
            border-left-color: var(--danger);
        }

        .pattern-human {
            border-left-color: var(--secondary);
        }

        /* Loading Animation */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 5px solid var(--gray-light);
            border-top: 5px solid var(--primary);
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Footer */
        footer {
            background: var(--light);
            padding: 30px;
            text-align: center;
            border-top: 1px solid var(--gray-light);
        }

        .footer-text {
            color: var(--gray);
            font-size: 0.9rem;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .main-content {
                padding: 20px;
            }
            
            header {
                padding: 30px 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .stats-bar {
                flex-direction: column;
                gap: 15px;
            }
            
            .button-group {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
            
            .file-actions {
                flex-direction: column;
            }
            
            .selected-file {
                flex-direction: column;
                gap: 15px;
                text-align: center;
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeIn 0.5s ease;
        }

        .pulse {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Detected Patterns Styles */
        .detected-patterns-container {
            margin-top: 20px;
        }

        .pattern-detail-card {
            background: white;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 10px;
            border-left: 4px solid;
            box-shadow: 0 3px 10px rgba(0,0,0,0.05);
        }

        .pattern-detail-ai {
            border-left-color: var(--danger);
            background: linear-gradient(135deg, rgba(239, 68, 68, 0.05), rgba(239, 68, 68, 0.02));
        }

        .pattern-detail-human {
            border-left-color: var(--secondary);
            background: linear-gradient(135deg, rgba(16, 185, 129, 0.05), rgba(16, 185, 129, 0.02));
        }

        .pattern-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .pattern-type-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .pattern-type-ai {
            background: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        .pattern-type-human {
            background: rgba(16, 185, 129, 0.1);
            color: var(--secondary);
        }

        .pattern-category {
            font-size: 0.85rem;
            color: var(--gray);
            margin-bottom: 5px;
        }

        .pattern-context {
            font-style: italic;
            color: var(--dark);
            margin: 10px 0;
            padding: 10px;
            background: rgba(0,0,0,0.02);
            border-radius: 8px;
            border-left: 3px solid var(--gray-light);
        }

        .pattern-sentence {
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--gray);
            padding: 8px;
            background: rgba(99, 102, 241, 0.03);
            border-radius: 6px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header>
            <div class="header-content">
                <h1><i class="fas fa-robot"></i> AI Text Detector</h1>
                <p class="tagline">Advanced AI detection with intelligent style recommendations</p>
                
                <div class="stats-bar">
                    <div class="stat-item">
                        <div class="stat-value" id="accuracy">94%</div>
                        <div class="stat-label">Detection Accuracy</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="model-version">4.0</div>
                        <div class="stat-label">Model Version</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="samples">10K+</div>
                        <div class="stat-label">Training Samples</div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Left Column: Input & Analysis -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-keyboard"></i>
                    </div>
                    <h2 class="card-title">Text Analysis</h2>
                </div>
                
                <!-- File Upload Section - MODIFIED -->
                <div class="file-upload-container">
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <div class="upload-text">Upload a Document</div>
                        <div class="upload-subtext">Files are automatically analyzed upon selection</div>
                        
                        <div class="supported-formats">
                            <span class="format-badge">
                                <i class="fas fa-file-alt"></i> .TXT
                            </span>
                            <span class="format-badge">
                                <i class="fas fa-file-word"></i> .DOCX
                            </span>
                            <span class="format-badge">
                                <i class="fas fa-file-pdf"></i> .PDF
                            </span>
                        </div>
                        
                        <input type="file" id="fileInput" class="file-input-hidden" 
                               accept=".txt,.docx,.pdf" onchange="handleFileSelect(event)">
                    </div>
                    
                    <div id="selectedFileContainer" style="display: none;">
                        <div class="selected-file">
                            <div class="file-info">
                                <div class="file-icon">
                                    <i class="fas fa-file"></i>
                                </div>
                                <div class="file-details">
                                    <div class="file-name" id="fileName">document.pdf</div>
                                    <div class="file-size" id="fileSize">1.2 MB</div>
                                </div>
                            </div>
                            <div class="file-actions">
                                <!-- REMOVED: Separate search icon button -->
                                <button class="file-action-btn file-remove-btn" onclick="clearSelectedFile()">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="text-area-container">
                    <textarea id="textInput" placeholder="Or enter text directly here..."></textarea>
                </div>
                
                <div class="button-group">
                    <button class="btn btn-primary" onclick="analyzeText()">
                        <i class="fas fa-search"></i> Analyze Text
                    </button>
                    <button class="btn btn-outline" onclick="clearText()">
                        <i class="fas fa-eraser"></i> Clear
                    </button>
                </div>

                <!-- Tabs -->
                <div class="tabs">
                    <div class="tab active" onclick="switchTab('detection')">Detection</div>
                    <div class="tab" onclick="switchTab('conversion')">Recommended Conversion</div>
                    <div class="tab" onclick="switchTab('explanation')">Explanation</div>
                    <!-- NEW TAB: Detected Patterns -->
                    <div class="tab" onclick="switchTab('patterns')">Detected Patterns</div>
                </div>

                <!-- Detection Tab -->
                <div id="detection-tab" class="tab-content active">
                    <div class="loading" id="detection-loading">
                        <div class="spinner"></div>
                        <p>Analyzing text patterns...</p>
                    </div>
                    
                    <div id="detection-results" style="display: none;">
                        <div id="prediction-card" class="prediction-card">
                            <div class="prediction-header">
                                <div class="prediction-badge">
                                    <i class="fas fa-robot"></i>
                                    <span id="prediction-text">AI-Generated</span>
                                </div>
                                <div class="confidence" id="confidence">Confidence: 92%</div>
                            </div>
                            
                            <div class="progress-container">
                                <div class="progress-label">
                                    <span>AI Probability</span>
                                    <span id="ai-percent">92%</span>
                                </div>
                                <div class="progress-bar">
                                    <div id="ai-progress" class="progress-fill progress-ai" style="width: 92%">
                                        <div class="progress-text">92%</div>
                                    </div>
                                </div>
                                
                                <div class="progress-label">
                                    <span>Human Probability</span>
                                    <span id="human-percent">8%</span>
                                </div>
                                <div class="progress-bar">
                                    <div id="human-progress" class="progress-fill progress-human" style="width: 8%">
                                        <div class="progress-text">8%</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="conversion-scores">
                            <h3 style="margin-bottom: 15px;">Recommended Conversion</h3>
                            <div class="conversion-stats">
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="ai-to-human-score">65%</div>
                                    <div class="stat-label-sm">AI → Human Needed</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="human-to-ai-score">35%</div>
                                    <div class="stat-label-sm">Human → AI Needed</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommended Conversion Tab -->
                <div id="conversion-tab" class="tab-content">
                    <div class="conversion-controls">
                        <h3 style="margin-bottom: 20px;">Apply Recommended Conversion</h3>
                        <p style="margin-bottom: 20px; color: var(--gray);">Based on your text analysis, we'll automatically apply the recommended style conversion.</p>
                        
                        <div class="intensity-control">
                            <div class="intensity-label">
                                <span>Conversion Intensity:</span>
                                <span id="intensity-value">0.5</span>
                            </div>
                            <div class="slider-container">
                                <input type="range" id="intensity-slider" min="0.1" max="1.0" step="0.1" value="0.5" 
                                       oninput="updateIntensity(this.value)">
                            </div>
                            <div class="slider-labels">
                                <span>Subtle</span>
                                <span>Balanced</span>
                                <span>Strong</span>
                            </div>
                        </div>
                        
                        <div class="button-group">
                            <button class="btn btn-primary" id="conversion-btn-main" onclick="applyRecommendedConversion()">
                                <i class="fas fa-magic"></i> Apply Recommended Conversion
                            </button>
                        </div>
                    </div>
                    
                    <div class="conversion-results" id="conversion-results" style="display: none;">
                        <div class="conversion-card">
                            <div class="conversion-header">
                                <h3>Conversion Results</h3>
                                <div class="conversion-percentage" id="conversion-percent">65%</div>
                            </div>
                            
                            <div class="conversion-stats">
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="words-changed">12</div>
                                    <div class="stat-label-sm">Words Changed</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="total-words">45</div>
                                    <div class="stat-label-sm">Total Words</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="intensity-used">0.7</div>
                                    <div class="stat-label-sm">Intensity Used</div>
                                </div>
                            </div>
                            
                            <h4 style="margin: 20px 0 10px;">Converted Text:</h4>
                            <div id="converted-text" style="background: #f8fafc; padding: 20px; border-radius: 12px; font-size: 1rem; line-height: 1.6;">
                                Converted text will appear here...
                            </div>
                            
                            <div class="button-group" style="margin-top: 20px;">
                                <button class="btn btn-outline" onclick="copyConvertedText()">
                                    <i class="fas fa-copy"></i> Copy Converted Text
                                </button>
                                <button class="btn btn-secondary" onclick="replaceOriginalText()">
                                    <i class="fas fa-exchange-alt"></i> Replace Original
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Explanation Tab -->
                <div id="explanation-tab" class="tab-content">
                    <div id="explanation-content" style="display: none;">
                        <div class="explanation-box">
                            <h3 style="margin-bottom: 15px;">Why This Text is Classified As <span id="classification-type">AI</span></h3>
                            <p id="explanation-text" style="margin-bottom: 20px; line-height: 1.6;"></p>
                            
                            <h4 style="margin-bottom: 15px;">Pattern Summary:</h4>
                            <div class="pattern-grid" id="pattern-grid">
                                <!-- Patterns will be inserted here -->
                            </div>
                            
                            <h4 style="margin: 20px 0 15px;">Text Statistics:</h4>
                            <div class="conversion-stats">
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="word-count">0</div>
                                    <div class="stat-label-sm">Words</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="sentence-count">0</div>
                                    <div class="stat-label-sm">Sentences</div>
                                </div>
                                <div class="stat-box">
                                    <div class="stat-value-lg" id="vocab-richness">0%</div>
                                    <div class="stat-label-sm">Vocabulary</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW: Detected Patterns Tab -->
                <div id="patterns-tab" class="tab-content">
                    <div class="loading" id="patterns-loading">
                        <div class="spinner"></div>
                        <p>Loading detected patterns...</p>
                    </div>
                    
                    <div id="patterns-content" style="display: none;">
                        <div class="explanation-box">
                            <h3 style="margin-bottom: 20px;">Detected Patterns Analysis</h3>
                            <p id="patterns-intro" style="margin-bottom: 20px; color: var(--gray);">
                                These patterns were detected in your text. Click on any pattern to see more details.
                            </p>
                            
                            <div class="pattern-stats" style="margin-bottom: 25px;">
                                <div class="conversion-stats">
                                    <div class="stat-box">
                                        <div class="stat-value-lg" id="total-patterns">0</div>
                                        <div class="stat-label-sm">Total Patterns</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-value-lg" id="ai-patterns-count">0</div>
                                        <div class="stat-label-sm">AI Patterns</div>
                                    </div>
                                    <div class="stat-box">
                                        <div class="stat-value-lg" id="human-patterns-count">0</div>
                                        <div class="stat-label-sm">Human Patterns</div>
                                    </div>
                                </div>
                            </div>
                            
                            <h4 style="margin-bottom: 15px;">Detailed Pattern Analysis:</h4>
                            <div class="detected-patterns-container" id="detailed-patterns-list">
                                <!-- Detailed patterns will be inserted here -->
                            </div>
                            
                            <div id="no-patterns-message" style="text-align: center; padding: 40px; color: var(--gray); display: none;">
                                <i class="fas fa-search" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                                <p>No specific patterns detected in this text. This could indicate neutral writing style.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Right Column: Style Analysis -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i class="fas fa-chart-pie"></i>
                    </div>
                    <h2 class="card-title">Style Analysis</h2>
                </div>
                
                <div class="loading" id="style-loading">
                    <div class="spinner"></div>
                    <p>Analyzing writing style...</p>
                </div>
                
                <div id="style-results" style="display: none;">
                    <!-- CHART MOVED HIGHER UP -->
                    <div style="text-align: center; margin-bottom: 15px; margin-top: -10px;">
                        <div style="position: relative; width: 180px; height: 180px; margin: 0 auto;">
                            <canvas id="style-chart"></canvas>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); text-align: center;">
                                <div style="font-size: 2.2rem; font-weight: 800;" id="ai-percent-chart">65%</div>
                                <div style="font-size: 0.8rem; color: var(--gray);">AI Score</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="progress-container">
                        <div class="progress-label">
                            <span>AI Writing Style</span>
                            <span id="ai-style-percent">65%</span>
                        </div>
                        <div class="progress-bar">
                            <div id="ai-style-progress" class="progress-fill progress-ai" style="width: 65%">
                                <div class="progress-text">65%</div>
                            </div>
                        </div>
                        
                        <div class="progress-label">
                            <span>Human Writing Style</span>
                            <span id="human-style-percent">35%</span>
                        </div>
                        <div class="progress-bar">
                            <div id="human-style-progress" class="progress-fill progress-human" style="width: 35%">
                                <div class="progress-text">35%</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="explanation-box" style="margin-top: 20px;">
                        <h3 style="margin-bottom: 15px;">Recommendations</h3>
                        <div id="recommendations">
                            <!-- Recommendations will be inserted here -->
                        </div>
                        
                        <h4 style="margin: 20px 0 10px;">Pattern Categories:</h4>
                        <div id="style-patterns">
                            <!-- Style patterns will be inserted here -->
                        </div>
                    </div>
                    
                    <div class="button-group" style="margin-top: 20px;">
                        <button class="btn btn-primary" id="conversion-btn-style" onclick="applyRecommendedConversion()">
                            <i class="fas fa-magic"></i> Apply Recommended Conversion
                        </button>
                    </div>
                </div>
                
                <div id="no-analysis" style="text-align: center; padding: 40px; color: var(--gray);">
                    <i class="fas fa-chart-bar" style="font-size: 3rem; margin-bottom: 20px; opacity: 0.3;"></i>
                    <p>Enter text and analyze to see style breakdown</p>
                </div>
            </div>
        </div>

        <!-- Footer -->
        <footer>
            <p class="footer-text">
                <i class="fas fa-code"></i> AI Text Detector • Version 4.0
            </p>
            <p class="footer-text" style="margin-top: 10px; font-size: 0.8rem;">
                Uses advanced machine learning with intelligent conversion recommendations
            </p>
        </footer>
    </div>

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <script>
        // Global variables
        let currentText = '';
        let currentAnalysis = null;
        let styleChart = null;
        let lastAnalysisResult = null;
        let selectedFile = null;
        let lastDetectedPatterns = [];
        
        // Text conversion patterns
        const aiPatterns = {
            words: {
                'utilize': 'use',
                'facilitate': 'help',
                'implement': 'do',
                'optimize': 'improve',
                'leverage': 'use',
                'synergize': 'work together',
                'paradigm': 'model',
                'robust': 'strong',
                'scalable': 'growable',
                'dynamic': 'changing',
                'innovative': 'new',
                'enhance': 'improve',
                'furthermore': 'also',
                'moreover': 'also',
                'nevertheless': 'but',
                'consequently': 'so',
                'accordingly': 'so',
                'subsequently': 'then',
                'therefore': 'so',
                'thus': 'so',
                'hence': 'so',
                'herein': 'here',
                'heretofore': 'before',
                'aforementioned': 'mentioned',
                'aforesaid': 'said',
                'notwithstanding': 'despite',
                'whereby': 'by which'
            },
            phrases: {
                'it is important to note that': 'note that',
                'in order to': 'to',
                'with regard to': 'about',
                'in relation to': 'about',
                'on a regular basis': 'regularly',
                'at this point in time': 'now',
                'for the purpose of': 'for',
                'in the event that': 'if',
                'prior to': 'before',
                'subsequent to': 'after',
                'due to the fact that': 'because',
                'in light of the fact that': 'because',
                'taking into consideration': 'considering',
                'as a matter of fact': 'actually',
                'it is evident that': 'clearly'
            },
            starters: [
                'To begin with',
                'Firstly',
                'Secondly',
                'Thirdly',
                'In conclusion',
                'Ultimately',
                'As previously mentioned',
                'It is noteworthy that',
                'It should be emphasized that',
                'From a broader perspective'
            ]
        };

        const humanPatterns = {
            words: {
                'like': 'resembling',
                'stuff': 'materials',
                'thing': 'element',
                'gonna': 'going to',
                'wanna': 'want to',
                'kinda': 'kind of',
                'sorta': 'sort of',
                'maybe': 'perhaps',
                'okay': 'acceptable',
                'cool': 'impressive',
                'awesome': 'remarkable',
                'uh': '',
                'um': '',
                'you know': '',
                'I mean': '',
                'so': 'therefore',
                'but': 'however',
                'and': 'furthermore',
                'really': 'substantially',
                'very': 'exceedingly',
                'pretty': 'moderately',
                'quite': 'considerably',
                'totally': 'completely'
            },
            phrases: {
                'you know what I mean': 'as you may understand',
                'I think that': 'it is considered that',
                'I feel like': 'it appears that',
                'sort of like': 'analogous to',
                'kind of like': 'somewhat similar to',
                'to be honest': 'in truth',
                'honestly': 'truthfully',
                'basically': 'fundamentally',
                'literally': 'in a literal sense',
                'actually': 'in actuality',
                'anyway': 'regardless',
                'so yeah': 'consequently',
                'you see': 'as observed',
                'I guess': 'it is presumed'
            },
            contractions: ["don't", "can't", "won't", "isn't", "aren't", "wasn't", "weren't", "haven't", "hasn't", "hadn't", "wouldn't", "couldn't", "shouldn't", "mightn't", "mustn't"]
        };

        // Initialize on load
        document.addEventListener('DOMContentLoaded', () => {
            setupExampleText();
            setupButtonStyles();
            setupFileUpload();
        });
        
        // Setup example text - FIXED: Starts empty
        function setupExampleText() {
            // Start with empty textarea
            document.getElementById('textInput').value = "";
        }
        
        // Setup button styles dynamically
        function setupButtonStyles() {
            // Add CSS for button states
            const style = document.createElement('style');
            style.textContent = `
                .btn[data-direction="ai_to_human"] {
                    background: linear-gradient(135deg, #ef4444, #10b981) !important;
                }
                
                .btn[data-direction="human_to_ai"] {
                    background: linear-gradient(135deg, #10b981, #ef4444) !important;
                }
                
                .btn:disabled {
                    opacity: 0.7 !important;
                    cursor: not-allowed !important;
                    transform: none !important;
                    box-shadow: none !important;
                }
            `;
            document.head.appendChild(style);
        }
        
        // Setup file upload functionality - MODIFIED
        function setupFileUpload() {
            const uploadArea = document.getElementById('uploadArea');
            const fileInput = document.getElementById('fileInput');
            
            // Click to upload
            uploadArea.addEventListener('click', () => {
                fileInput.click();
            });
            
            // Drag and drop
            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });
            
            uploadArea.addEventListener('dragleave', () => {
                uploadArea.classList.remove('drag-over');
            });
            
            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                
                if (e.dataTransfer.files.length > 0) {
                    handleFile(e.dataTransfer.files[0]);
                }
            });
        }
        
        // Handle file selection - MODIFIED: Auto-analyze on file select
        function handleFileSelect(event) {
            if (event.target.files.length > 0) {
                handleFile(event.target.files[0]);
            }
        }
        
        // Handle file - MODIFIED: Auto-analyze
        function handleFile(file) {
            // Validate file type
            const validTypes = ['text/plain', 'application/pdf', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document'];
            const validExtensions = ['.txt', '.pdf', '.docx'];
            
            const fileExtension = file.name.substring(file.name.lastIndexOf('.')).toLowerCase();
            
            if (!validExtensions.includes(fileExtension)) {
                alert('Please upload only .txt, .pdf, or .docx files');
                return;
            }
            
            // Validate file size (10MB limit)
            if (file.size > 10 * 1024 * 1024) {
                alert('File size exceeds 10MB limit');
                return;
            }
            
            selectedFile = file;
            
            // Update UI to show selected file
            document.getElementById('fileName').textContent = file.name;
            document.getElementById('fileSize').textContent = formatFileSize(file.size);
            
            // Update file icon based on type
            const fileIcon = document.querySelector('.file-icon i');
            if (fileExtension === '.pdf') {
                fileIcon.className = 'fas fa-file-pdf';
            } else if (fileExtension === '.docx') {
                fileIcon.className = 'fas fa-file-word';
            } else {
                fileIcon.className = 'fas fa-file-alt';
            }
            
            document.getElementById('selectedFileContainer').style.display = 'block';
            
            // Show loading and auto-analyze
            showToast('File uploaded successfully! Analyzing content...', 'success');
            setTimeout(() => {
                analyzeUploadedFile();
            }, 500);
        }
        
        // Format file size
        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }
        
        // Analyze uploaded file - MODIFIED: Now uses /api/analyze-file endpoint
        async function analyzeUploadedFile() {
            if (!selectedFile) {
                alert('Please select a file first');
                return;
            }
            
            // Show loading
            document.getElementById('detection-loading').style.display = 'block';
            document.getElementById('detection-results').style.display = 'none';
            document.getElementById('patterns-loading').style.display = 'block';
            document.getElementById('patterns-content').style.display = 'none';
            
            // Create FormData for file upload
            const formData = new FormData();
            formData.append('file', selectedFile);
            
            try {
                // Call the new backend API
                const response = await fetch('/api/analyze-file', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    // Store the detected patterns for pattern tab
                    if (result.explanation && result.explanation.detected_patterns) {
                        lastDetectedPatterns = result.explanation.detected_patterns;
                    }
                    
                    // Update textarea with extracted text
                    document.getElementById('textInput').value = result.text;
                    
                    // Update the analysis results using the backend data
                    updateDetectionResults(result);
                    updateExplanation(result);
                    
                    // Update style analysis if available
                    if (result.style_analysis) {
                        updateStyleAnalysis(result.style_analysis);
                    }
                    
                    // Update patterns tab
                    updatePatternsTab(result);
                    
                    // Update conversion button
                    const styleAnalysis = result.style_analysis || {};
                    updateConversionButton(result.prediction, styleAnalysis);
                    
                    // Switch to detection tab
                    switchTab('detection');
                    
                    // Show success message
                    showToast('File analyzed successfully!', 'success');
                } else {
                    throw new Error(result.error || 'Failed to analyze file');
                }
            } catch (error) {
                // Fallback to simulated analysis if API fails
                console.warn('API call failed, using simulated analysis:', error);
                simulateFileAnalysis();
            } finally {
                // Hide loading
                document.getElementById('detection-loading').style.display = 'none';
                document.getElementById('patterns-loading').style.display = 'none';
            }
        }
        
        // Update patterns tab with detected patterns
        function updatePatternsTab(data) {
            const patternsContent = document.getElementById('patterns-content');
            const detailedPatternsList = document.getElementById('detailed-patterns-list');
            const noPatternsMessage = document.getElementById('no-patterns-message');
            
            detailedPatternsList.innerHTML = '';
            
            if (data.explanation && data.explanation.detected_patterns && data.explanation.detected_patterns.length > 0) {
                const patterns = data.explanation.detected_patterns;
                
                // Update pattern counts
                document.getElementById('total-patterns').textContent = patterns.length;
                const aiPatternsCount = patterns.filter(p => p.type === 'AI').length;
                const humanPatternsCount = patterns.filter(p => p.type === 'Human').length;
                document.getElementById('ai-patterns-count').textContent = aiPatternsCount;
                document.getElementById('human-patterns-count').textContent = humanPatternsCount;
                
                // Update patterns intro text
                const patternsIntro = document.getElementById('patterns-intro');
                patternsIntro.textContent = `Found ${patterns.length} patterns (${aiPatternsCount} AI, ${humanPatternsCount} Human) in your text. These patterns help determine whether the text is AI-generated or human-written.`;
                
                // Display each pattern
                patterns.forEach((pattern, index) => {
                    const patternCard = document.createElement('div');
                    patternCard.className = `pattern-detail-card pattern-detail-${pattern.type.toLowerCase()}`;
                    
                    patternCard.innerHTML = `
                        <div class="pattern-header">
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-weight: 600; color: var(--dark);">${pattern.pattern}</span>
                                <span class="pattern-type-badge pattern-type-${pattern.type.toLowerCase()}">
                                    ${pattern.type}
                                </span>
                            </div>
                            <span style="font-size: 0.8rem; color: var(--gray);">#${index + 1}</span>
                        </div>
                        <div class="pattern-category">
                            <i class="fas fa-tag"></i> ${pattern.category}
                        </div>
                        ${pattern.context ? `
                        <div class="pattern-context">
                            <strong>Context:</strong> ${pattern.context}
                        </div>
                        ` : ''}
                        ${pattern.sentence ? `
                        <div class="pattern-sentence">
                            <i class="fas fa-quote-left"></i> ${pattern.sentence}
                        </div>
                        ` : ''}
                    `;
                    
                    detailedPatternsList.appendChild(patternCard);
                });
                
                patternsContent.style.display = 'block';
                noPatternsMessage.style.display = 'none';
            } else {
                // No patterns detected
                patternsContent.style.display = 'block';
                noPatternsMessage.style.display = 'block';
                
                // Update counts
                document.getElementById('total-patterns').textContent = '0';
                document.getElementById('ai-patterns-count').textContent = '0';
                document.getElementById('human-patterns-count').textContent = '0';
            }
        }
        
        // Simulate file analysis (fallback)
        function simulateFileAnalysis() {
            // Read the file and simulate analysis
            const reader = new FileReader();
            
            reader.onload = function(e) {
                let text = e.target.result;
                
                // For non-text files, just show a sample
                if (!selectedFile.type.startsWith('text/') && 
                    selectedFile.name.endsWith('.pdf') || 
                    selectedFile.name.endsWith('.docx')) {
                    text = "This is simulated text extracted from the uploaded document. In a real implementation, this text would be extracted from the actual file content. For PDF files, text extraction would work on text-based PDFs. For DOCX files, the text would be extracted from the document structure.";
                }
                
                // Set text in textarea
                document.getElementById('textInput').value = text;
                
                // Analyze the text
                setTimeout(() => {
                    analyzeText();
                }, 500);
            };
            
            // Read the file based on type
            if (selectedFile.type.startsWith('text/')) {
                reader.readAsText(selectedFile);
            } else {
                // For non-text files, just use a placeholder
                reader.readAsDataURL(selectedFile);
            }
        }
        
        // Clear selected file
        function clearSelectedFile() {
            selectedFile = null;
            document.getElementById('selectedFileContainer').style.display = 'none';
            document.getElementById('fileInput').value = '';
            
            // Clear any file-related results
            document.getElementById('detection-results').style.display = 'none';
            document.getElementById('explanation-content').style.display = 'none';
            document.getElementById('patterns-content').style.display = 'none';
        }
        
        // Show toast message
        function showToast(message, type = 'info') {
            // Create toast element
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                bottom: 20px;
                right: 20px;
                background: ${type === 'success' ? 'var(--secondary)' : 'var(--primary)'};
                color: white;
                padding: 15px 25px;
                border-radius: 12px;
                box-shadow: 0 5px 15px rgba(0,0,0,0.2);
                z-index: 1000;
                animation: slideIn 0.3s ease;
                max-width: 300px;
                font-weight: 500;
            `;
            
            toast.innerHTML = `
                <div style="display: flex; align-items: center; gap: 10px;">
                    <i class="fas fa-${type === 'success' ? 'check-circle' : 'info-circle'}"></i>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(toast);
            
            // Remove toast after 3 seconds
            setTimeout(() => {
                toast.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => {
                    document.body.removeChild(toast);
                }, 300);
            }, 3000);
            
            // Add animation styles
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
            `;
            document.head.appendChild(style);
        }
        
        // Function to update conversion button text
        function updateConversionButton(prediction, styleAnalysis) {
            const buttons = [
                document.getElementById('conversion-btn-main'),
                document.getElementById('conversion-btn-style')
            ];
            
            buttons.forEach(button => {
                if (!button) return;
                
                const icon = button.querySelector('i');
                const iconClass = icon ? icon.className : 'fas fa-magic';
                
                if (prediction === 'AI') {
                    button.innerHTML = `<i class="${iconClass}"></i> Convert AI to Human`;
                    button.title = "Convert AI-generated text to human-like style";
                    button.setAttribute('data-direction', 'ai_to_human');
                } else {
                    button.innerHTML = `<i class="${iconClass}"></i> Convert Human to AI`;
                    button.title = "Convert human-written text to AI-like style";
                    button.setAttribute('data-direction', 'human_to_ai');
                }
                
                // Update based on style analysis if available
                if (styleAnalysis && styleAnalysis.recommended_conversion) {
                    if (styleAnalysis.recommended_conversion === 'ai_to_human') {
                        button.innerHTML = `<i class="${iconClass}"></i> Apply: AI → Human`;
                        button.setAttribute('data-direction', 'ai_to_human');
                    } else {
                        button.innerHTML = `<i class="${iconClass}"></i> Apply: Human → AI`;
                        button.setAttribute('data-direction', 'human_to_ai');
                    }
                }
            });
        }
        
        // Tab switching
        function switchTab(tabName) {
            // Update tabs
            document.querySelectorAll('.tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
            });
            
            // Activate selected tab
            let tabIndex = 1;
            if (tabName === 'detection') tabIndex = 1;
            else if (tabName === 'conversion') tabIndex = 2;
            else if (tabName === 'explanation') tabIndex = 3;
            else if (tabName === 'patterns') tabIndex = 4;
            
            document.querySelector(`.tab:nth-child(${tabIndex})`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            // Load patterns if needed
            if (tabName === 'patterns' && lastAnalysisResult) {
                updatePatternsTab(lastAnalysisResult);
            }
        }
        
        // Update intensity value
        function updateIntensity(value) {
            document.getElementById('intensity-value').textContent = value;
        }
        
        // Calculate AI probability based on patterns
        function calculateAIProbability(text) {
            let aiScore = 0;
            const words = text.toLowerCase().split(/\s+/);
            
            // Check for AI patterns
            for (const [aiWord] of Object.entries(aiPatterns.words)) {
                if (text.toLowerCase().includes(aiWord.toLowerCase())) {
                    aiScore += 5;
                }
            }
            
            for (const [aiPhrase] of Object.entries(aiPatterns.phrases)) {
                if (text.toLowerCase().includes(aiPhrase.toLowerCase())) {
                    aiScore += 10;
                }
            }
            
            // Check for formal structure
            if (text.split(/[.!?]+/).length > 3) {
                const sentences = text.split(/[.!?]+/);
                const starters = sentences.filter(s => 
                    aiPatterns.starters.some(starter => 
                        s.trim().toLowerCase().startsWith(starter.toLowerCase())
                    )
                ).length;
                aiScore += starters * 8;
            }
            
            // Check for human patterns (reduce AI score)
            for (const [humanWord] of Object.entries(humanPatterns.words)) {
                const regex = new RegExp(`\\b${humanWord}\\b`, 'gi');
                const matches = text.match(regex);
                if (matches) {
                    aiScore -= matches.length * 3;
                }
            }
            
            for (const phrase of humanPatterns.contractions) {
                if (text.toLowerCase().includes(phrase)) {
                    aiScore -= 5;
                }
            }
            
            // Calculate probability
            const maxScore = 100;
            const minScore = 0;
            const normalizedScore = Math.max(minScore, Math.min(maxScore, 50 + aiScore));
            
            return Math.round(normalizedScore);
        }
        
        // Count AI patterns
        function countAIPatterns(text) {
            const patterns = {};
            const lowerText = text.toLowerCase();
            
            // Count AI words
            for (const [word] of Object.entries(aiPatterns.words)) {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                const matches = text.match(regex);
                if (matches && matches.length > 0) {
                    patterns[word] = matches.length;
                }
            }
            
            // Count AI phrases
            for (const [phrase] of Object.entries(aiPatterns.phrases)) {
                if (lowerText.includes(phrase)) {
                    patterns[phrase] = 1;
                }
            }
            
            return patterns;
        }
        
        // Count human patterns
        function countHumanPatterns(text) {
            const patterns = {};
            const lowerText = text.toLowerCase();
            
            // Count human words
            for (const [word] of Object.entries(humanPatterns.words)) {
                const regex = new RegExp(`\\b${word}\\b`, 'gi');
                const matches = text.match(regex);
                if (matches && matches.length > 0) {
                    patterns[word] = matches.length;
                }
            }
            
            // Count contractions
            for (const contraction of humanPatterns.contractions) {
                if (lowerText.includes(contraction)) {
                    patterns[contraction] = 1;
                }
            }
            
            return patterns;
        }
        
        // Analyze text (simulated detection) - MODIFIED: Use /api/analyze-text endpoint
        async function analyzeText() {
            const text = document.getElementById('textInput').value.trim();
            if (!text) {
                alert('Please enter some text to analyze.');
                return;
            }
            
            currentText = text;
            
            // Show loading
            document.getElementById('detection-loading').style.display = 'block';
            document.getElementById('detection-results').style.display = 'none';
            document.getElementById('explanation-content').style.display = 'none';
            document.getElementById('patterns-loading').style.display = 'block';
            document.getElementById('patterns-content').style.display = 'none';
            
            // Try to use new unified backend API
            try {
                const response = await fetch('/api/analyze-text', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        text: text,
                        analysis_type: 'full' 
                    })
                });
                
                const data = await response.json();
                
                if (data.success) {
                    lastAnalysisResult = data;
                    
                    // Update detection results
                    if (data.prediction) {
                        updateDetectionResults(data);
                    }
                    
                    // Update explanation
                    updateExplanation(data);
                    
                    // Update style analysis if available
                    if (data.style_analysis) {
                        updateStyleAnalysis(data.style_analysis);
                    }
                    
                    // Update patterns tab
                    if (data.pattern_analysis) {
                        lastDetectedPatterns = data.pattern_analysis.detected_patterns || [];
                        updatePatternsTab(data);
                    }
                    
                    switchTab('detection');
                    
                    // Update conversion button text
                    const styleAnalysis = data.style_analysis || {};
                    updateConversionButton(data.prediction || 'Unknown', styleAnalysis);
                } else {
                    throw new Error(data.error);
                }
            } catch (error) {
                // Fallback to simulated analysis
                console.warn('API call failed, using simulated analysis:', error);
                
                // Calculate AI probability based on text patterns
                const aiProbability = calculateAIProbability(text);
                const humanProbability = 100 - aiProbability;
                
                // Create simulated response
                const data = {
                    success: true,
                    prediction: aiProbability > 50 ? 'AI' : 'Human',
                    probabilities: {
                        AI: Math.round(aiProbability),
                        Human: Math.round(humanProbability)
                    },
                    confidence: Math.round(Math.max(aiProbability, humanProbability)),
                    conversion_scores: {
                        ai_to_human: Math.round(aiProbability),
                        human_to_ai: Math.round(humanProbability)
                    },
                    explanation: {
                        prediction_text: aiProbability > 50 
                            ? "This text exhibits patterns commonly found in AI-generated content." 
                            : "This text shows characteristics typical of human writing.",
                        confidence_level: aiProbability > 70 || humanProbability > 70 
                            ? "High confidence in classification." 
                            : "Moderate confidence in classification.",
                        text_statistics: {
                            word_count: text.split(/\s+/).length,
                            sentence_count: text.split(/[.!?]+/).filter(s => s.trim().length > 0).length,
                            vocabulary_richness: Math.min(100, Math.round((new Set(text.toLowerCase().match(/\b\w+\b/g)).size / text.split(/\s+/).length) * 1000))
                        },
                        pattern_analysis: {
                            ai_patterns: countAIPatterns(text),
                            human_patterns: countHumanPatterns(text)
                        }
                    }
                };
                
                lastAnalysisResult = data;
                updateDetectionResults(data);
                updateExplanation(data);
                switchTab('detection');
                
                // Also update style analysis
                analyzeStyle();
                
                // Update conversion button text
                const styleAnalysis = currentAnalysis || {};
                updateConversionButton(data.prediction, styleAnalysis);
            } finally {
                // Hide loading
                document.getElementById('detection-loading').style.display = 'none';
                document.getElementById('patterns-loading').style.display = 'none';
            }
        }
        
        // Update detection results
        function updateDetectionResults(data) {
            const isAI = data.prediction === 'AI';
            const aiPercent = data.probabilities.AI;
            const humanPercent = data.probabilities.Human;
            const confidence = data.confidence;
            const conversionScores = data.conversion_scores;
            
            // Update prediction card
            const card = document.getElementById('prediction-card');
            card.className = isAI ? 'prediction-card prediction-ai' : 'prediction-card prediction-human';
            
            document.getElementById('prediction-text').innerHTML = 
                `${isAI ? '<i class="fas fa-robot"></i>' : '<i class="fas fa-user"></i>'} ${isAI ? 'AI-Generated' : 'Human-Written'}`;
            
            // Update confidence
            document.getElementById('confidence').textContent = `Confidence: ${confidence}%`;
            
            // Update percentages
            document.getElementById('ai-percent').textContent = `${aiPercent}%`;
            document.getElementById('human-percent').textContent = `${humanPercent}%`;
            
            // Animate progress bars
            setTimeout(() => {
                document.getElementById('ai-progress').style.width = `${aiPercent}%`;
                document.getElementById('ai-progress').innerHTML = `<div class="progress-text">${aiPercent}%</div>`;
                document.getElementById('human-progress').style.width = `${humanPercent}%`;
                document.getElementById('human-progress').innerHTML = `<div class="progress-text">${humanPercent}%</div>`;
            }, 100);
            
            // Update conversion scores
            if (conversionScores) {
                document.getElementById('ai-to-human-score').textContent = `${conversionScores.ai_to_human}%`;
                document.getElementById('human-to-ai-score').textContent = `${conversionScores.human_to_ai}%`;
            }
            
            // Show results
            document.getElementById('detection-results').style.display = 'block';
        }
        
        // Update explanation
        function updateExplanation(data) {
            const explanation = data.explanation;
            
            document.getElementById('classification-type').textContent = 
                data.prediction === 'AI' ? 'AI' : 'Human';
            document.getElementById('explanation-text').textContent = 
                explanation.prediction_text + ' ' + explanation.confidence_level;
            
            // Update text statistics
            const stats = explanation.text_statistics;
            document.getElementById('word-count').textContent = stats.word_count;
            document.getElementById('sentence-count').textContent = stats.sentence_count;
            document.getElementById('vocab-richness').textContent = stats.vocabulary_richness + '%';
            
            // Update patterns
            const patternGrid = document.getElementById('pattern-grid');
            patternGrid.innerHTML = '';
            
            const aiPatterns = explanation.pattern_analysis?.ai_patterns || {};
            const humanPatterns = explanation.pattern_analysis?.human_patterns || {};
            
            // Add AI patterns
            for (const [category, count] of Object.entries(aiPatterns)) {
                const patternItem = document.createElement('div');
                patternItem.className = 'pattern-item pattern-ai';
                patternItem.innerHTML = `
                    <div style="font-weight: 600; margin-bottom: 5px;">${category.toUpperCase()}</div>
                    <div style="font-size: 0.9rem; color: var(--gray);">${count} instances</div>
                `;
                patternGrid.appendChild(patternItem);
            }
            
            // Add Human patterns
            for (const [category, count] of Object.entries(humanPatterns)) {
                const patternItem = document.createElement('div');
                patternItem.className = 'pattern-item pattern-human';
                patternItem.innerHTML = `
                    <div style="font-weight: 600; margin-bottom: 5px;">${category.toUpperCase()}</div>
                    <div style="font-size: 0.9rem; color: var(--gray);">${count} instances</div>
                `;
                patternGrid.appendChild(patternItem);
            }
            
            document.getElementById('explanation-content').style.display = 'block';
        }
        
        // Analyze style
        async function analyzeStyle() {
            const text = document.getElementById('textInput').value.trim();
            if (!text) {
                alert('Please enter some text first.');
                return;
            }
            
            // Show loading
            document.getElementById('style-loading').style.display = 'block';
            document.getElementById('style-results').style.display = 'none';
            document.getElementById('no-analysis').style.display = 'none';
            
            // Try to use backend API first
            try {
                const response = await fetch('/api/analyze', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ text: text })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    updateStyleAnalysis(result.analysis);
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                // Fallback to simulated analysis
                console.warn('API call failed, using simulated analysis:', error);
                
                // Calculate style analysis
                const aiPercent = calculateAIProbability(text);
                const humanPercent = 100 - aiPercent;
                
                // Determine recommendations based on analysis
                const recommendations = [];
                if (aiPercent > 70) {
                    recommendations.push("Consider using more casual language and contractions");
                    recommendations.push("Add personal opinions or anecdotes");
                    recommendations.push("Use shorter, more varied sentence structures");
                } else if (humanPercent > 70) {
                    recommendations.push("Consider using more formal vocabulary");
                    recommendations.push("Structure arguments more systematically");
                    recommendations.push("Use transitional phrases to connect ideas");
                }
                
                // Get detected patterns
                const aiPatternsFound = Object.keys(countAIPatterns(text)).slice(0, 5);
                const humanPatternsFound = Object.keys(countHumanPatterns(text)).slice(0, 5);
                
                // Determine recommended conversion
                const recommendedConversion = aiPercent > 50 ? 'ai_to_human' : 'human_to_ai';
                
                // Create analysis data
                const analysis = {
                    ai_percentage: aiPercent,
                    human_percentage: humanPercent,
                    suggestions: recommendations,
                    ai_patterns_found: aiPatternsFound,
                    human_patterns_found: humanPatternsFound,
                    recommended_conversion: recommendedConversion
                };
                
                currentAnalysis = analysis;
                updateStyleAnalysis(analysis);
                
                // Update conversion button text
                updateConversionButton(aiPercent > 50 ? 'AI' : 'Human', analysis);
            } finally {
                // Hide loading
                document.getElementById('style-loading').style.display = 'none';
            }
        }
        
        // Update style analysis
        function updateStyleAnalysis(analysis) {
            const aiPercent = analysis.ai_percentage;
            const humanPercent = analysis.human_percentage;
            const recommendations = analysis.suggestions || [];
            
            // Update chart
            updateStyleChart(aiPercent, humanPercent);
            
            // Update percentages
            document.getElementById('ai-style-percent').textContent = `${aiPercent}%`;
            document.getElementById('human-style-percent').textContent = `${humanPercent}%`;
            document.getElementById('ai-percent-chart').textContent = `${aiPercent}%`;
            
            // Animate progress bars
            setTimeout(() => {
                document.getElementById('ai-style-progress').style.width = `${aiPercent}%`;
                document.getElementById('ai-style-progress').innerHTML = `<div class="progress-text">${aiPercent}%</div>`;
                document.getElementById('human-style-progress').style.width = `${humanPercent}%`;
                document.getElementById('human-style-progress').innerHTML = `<div class="progress-text">${humanPercent}%</div>`;
            }, 100);
            
            // Update recommendations
            const recommendationsDiv = document.getElementById('recommendations');
            recommendationsDiv.innerHTML = '';
            
            recommendations.forEach(rec => {
                const recItem = document.createElement('div');
                recItem.style.marginBottom = '10px';
                recItem.style.padding = '10px';
                recItem.style.background = 'white';
                recItem.style.borderRadius = '8px';
                recItem.style.borderLeft = '4px solid var(--primary)';
                recItem.innerHTML = `<i class="fas fa-lightbulb" style="color: var(--warning); margin-right: 10px;"></i> ${rec}`;
                recommendationsDiv.appendChild(recItem);
            });
            
            // Update patterns
            const patternsDiv = document.getElementById('style-patterns');
            patternsDiv.innerHTML = '';
            
            const aiPatternsFound = analysis.ai_patterns_found || [];
            const humanPatternsFound = analysis.human_patterns_found || [];
            
            aiPatternsFound.forEach(pattern => {
                const patternItem = document.createElement('div');
                patternItem.style.display = 'inline-block';
                patternItem.style.margin = '5px';
                patternItem.style.padding = '5px 10px';
                patternItem.style.background = 'rgba(239, 68, 68, 0.1)';
                patternItem.style.color = 'var(--danger)';
                patternItem.style.borderRadius = '20px';
                patternItem.style.fontSize = '0.9rem';
                patternItem.textContent = pattern;
                patternsDiv.appendChild(patternItem);
            });
            
            humanPatternsFound.forEach(pattern => {
                const patternItem = document.createElement('div');
                patternItem.style.display = 'inline-block';
                patternItem.style.margin = '5px';
                patternItem.style.padding = '5px 10px';
                patternItem.style.background = 'rgba(16, 185, 129, 0.1)';
                patternItem.style.color = 'var(--secondary)';
                patternItem.style.borderRadius = '20px';
                patternItem.style.fontSize = '0.9rem';
                patternItem.textContent = pattern;
                patternsDiv.appendChild(patternItem);
            });
            
            document.getElementById('style-results').style.display = 'block';
        }
        
        // Update style chart
        function updateStyleChart(aiPercent, humanPercent) {
            const ctx = document.getElementById('style-chart').getContext('2d');
            
            // Destroy existing chart
            if (styleChart) {
                styleChart.destroy();
            }
            
            styleChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['AI Style', 'Human Style'],
                    datasets: [{
                        data: [aiPercent, humanPercent],
                        backgroundColor: [
                            'rgba(239, 68, 68, 0.8)',
                            'rgba(16, 185, 129, 0.8)'
                        ],
                        borderColor: [
                            'rgba(239, 68, 68, 1)',
                            'rgba(16, 185, 129, 1)'
                        ],
                        borderWidth: 2,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '70%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.label}: ${context.parsed}%`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Apply recommended conversion
        async function applyRecommendedConversion() {
            if (!currentAnalysis) {
                alert('Please analyze text first.');
                return;
            }
            
            const recommended = currentAnalysis.recommended_conversion;
            const intensity = parseFloat(document.getElementById('intensity-value').textContent);
            
            const text = document.getElementById('textInput').value.trim();
            if (!text) {
                alert('Please enter some text to convert.');
                return;
            }
            
            // Show processing on both buttons
            const buttons = [
                document.getElementById('conversion-btn-main'),
                document.getElementById('conversion-btn-style')
            ];
            
            buttons.forEach(button => {
                if (button) {
                    button.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Converting...';
                    button.disabled = true;
                }
            });
            
            // Show processing
            document.getElementById('conversion-results').style.display = 'none';
            const conversionResults = document.querySelector('.conversion-results');
            if (conversionResults) {
                conversionResults.innerHTML = '<div class="loading"><div class="spinner"></div><p>Applying recommended conversion...</p></div>';
            }
            
            // Try to use backend API first
            try {
                const response = await fetch('/api/apply-recommended', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ 
                        text: text,
                        intensity: intensity 
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    updateConversionResults(result.result);
                    switchTab('conversion');
                } else {
                    throw new Error(result.error);
                }
            } catch (error) {
                // Fallback to simulated conversion
                console.warn('API call failed, using simulated conversion:', error);
                
                let convertedText = text;
                let wordsChanged = 0;
                const totalWords = text.split(/\s+/).length;
                
                if (recommended === 'ai_to_human') {
                    // Convert AI to human
                    convertedText = convertAIToHuman(text, intensity);
                    wordsChanged = countWordChanges(text, convertedText);
                } else {
                    // Convert human to AI
                    convertedText = convertHumanToAI(text, intensity);
                    wordsChanged = countWordChanges(text, convertedText);
                }
                
                const conversionPercentage = Math.round((wordsChanged / totalWords) * 100 * intensity);
                
                const result = {
                    conversion_percentage: conversionPercentage,
                    words_changed: wordsChanged,
                    total_words: totalWords,
                    intensity_used: intensity,
                    converted_text: convertedText,
                    direction: recommended
                };
                
                updateConversionResults(result);
                switchTab('conversion');
            } finally {
                // Re-enable buttons and update their text
                setTimeout(() => {
                    buttons.forEach(button => {
                        if (button) {
                            button.disabled = false;
                            // Update button to show opposite conversion
                            if (recommended === 'ai_to_human') {
                                button.innerHTML = '<i class="fas fa-magic"></i> Apply: Human → AI';
                                button.setAttribute('data-direction', 'human_to_ai');
                            } else {
                                button.innerHTML = '<i class="fas fa-magic"></i> Apply: AI → Human';
                                button.setAttribute('data-direction', 'ai_to_human');
                            }
                        }
                    });
                }, 500);
            }
        }
        
        // Convert AI text to human-like text
        function convertAIToHuman(text, intensity) {
            let result = text;
            
            // Apply word replacements based on intensity
            for (const [aiWord, humanWord] of Object.entries(aiPatterns.words)) {
                const regex = new RegExp(`\\b${aiWord}\\b`, 'gi');
                if (Math.random() < intensity) {
                    result = result.replace(regex, humanWord);
                }
            }
            
            // Apply phrase replacements
            for (const [aiPhrase, humanPhrase] of Object.entries(aiPatterns.phrases)) {
                if (Math.random() < intensity * 0.7) {
                    result = result.replace(new RegExp(aiPhrase, 'gi'), humanPhrase);
                }
            }
            
            // Add some human-like elements
            if (intensity > 0.5) {
                // Add occasional contractions
                result = result.replace(/\bdo not\b/gi, "don't");
                result = result.replace(/\bcannot\b/gi, "can't");
                result = result.replace(/\bwill not\b/gi, "won't");
                
                // Add informal starters
                const sentences = result.split(/(?<=[.!?])\s+/);
                if (sentences.length > 2 && Math.random() < intensity) {
                    const informalStarters = ["I think", "You know", "Honestly", "Basically", "So"];
                    const randomStarter = informalStarters[Math.floor(Math.random() * informalStarters.length)];
                    sentences[1] = randomStarter + ", " + sentences[1].toLowerCase();
                    result = sentences.join(' ');
                }
            }
            
            return result;
        }
        
        // Convert human text to AI-like text
        function convertHumanToAI(text, intensity) {
            let result = text;
            
            // Apply word replacements based on intensity
            for (const [humanWord, aiWord] of Object.entries(humanPatterns.words)) {
                const regex = new RegExp(`\\b${humanWord}\\b`, 'gi');
                if (Math.random() < intensity) {
                    result = result.replace(regex, aiWord);
                }
            }
            
            // Remove contractions
            for (const contraction of humanPatterns.contractions) {
                if (Math.random() < intensity) {
                    const expanded = contraction.replace("n't", " not").replace("'m", " am").replace("'re", " are").replace("'s", " is").replace("'ll", " will").replace("'ve", " have");
                    result = result.replace(new RegExp(contraction, 'gi'), expanded);
                }
            }
            
            // Add formal structure
            if (intensity > 0.5 && result.split(/[.!?]+/).length > 1) {
                const sentences = result.split(/(?<=[.!?])\s+/);
                if (sentences.length > 1) {
                    // Add transitional phrases
                    const transitions = ["Furthermore", "Moreover", "Consequently", "Therefore", "Accordingly"];
                    for (let i = 1; i < Math.min(sentences.length, 3); i++) {
                        if (Math.random() < intensity * 0.5) {
                            const transition = transitions[Math.floor(Math.random() * transitions.length)];
                            sentences[i] = transition + ", " + sentences[i].toLowerCase();
                        }
                    }
                    result = sentences.join(' ');
                }
            }
            
            return result;
        }
        
        // Count word changes between texts
        function countWordChanges(original, converted) {
            const origWords = original.toLowerCase().split(/\s+/);
            const convWords = converted.toLowerCase().split(/\s+/);
            let changes = 0;
            
            for (let i = 0; i < Math.min(origWords.length, convWords.length); i++) {
                if (origWords[i] !== convWords[i]) {
                    changes++;
                }
            }
            
            return changes + Math.abs(origWords.length - convWords.length);
        }
        
        // Update conversion results
        function updateConversionResults(result) {
            const directionText = result.direction === 'ai_to_human' ? 'AI → Human' : 'Human → AI';
            
            document.querySelector('.conversion-results').innerHTML = `
                <div class="conversion-card">
                    <div class="conversion-header">
                        <h3>Conversion Results: ${directionText}</h3>
                        <div class="conversion-percentage" id="conversion-percent">${result.conversion_percentage}%</div>
                    </div>
                    
                    <div class="conversion-stats">
                        <div class="stat-box">
                            <div class="stat-value-lg" id="words-changed">${result.words_changed}</div>
                            <div class="stat-label-sm">Words Changed</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value-lg" id="total-words">${result.total_words}</div>
                            <div class="stat-label-sm">Total Words</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value-lg" id="intensity-used">${result.intensity_used.toFixed(1)}</div>
                            <div class="stat-label-sm">Intensity Used</div>
                        </div>
                    </div>
                    
                    <h4 style="margin: 20px 0 10px;">Converted Text:</h4>
                    <div id="converted-text" style="background: #f8fafc; padding: 20px; border-radius: 12px; font-size: 1rem; line-height: 1.6;">
                        ${result.converted_text}
                    </div>
                    
                    <div class="button-group" style="margin-top: 20px;">
                        <button class="btn btn-outline" onclick="copyConvertedText()">
                            <i class="fas fa-copy"></i> Copy Converted Text
                        </button>
                        <button class="btn btn-secondary" onclick="replaceOriginalText()">
                            <i class="fas fa-exchange-alt"></i> Replace Original
                        </button>
                    </div>
                </div>
            `;
            
            // Animate percentage
            const percentElement = document.getElementById('conversion-percent');
            if (percentElement) {
                percentElement.classList.add('pulse');
                setTimeout(() => {
                    percentElement.classList.remove('pulse');
                }, 2000);
            }
            
            document.getElementById('conversion-results').style.display = 'block';
        }
        
        // Copy converted text
        function copyConvertedText() {
            const convertedText = document.getElementById('converted-text').textContent;
            navigator.clipboard.writeText(convertedText).then(() => {
                alert('Converted text copied to clipboard!');
            });
        }
        
        // Replace original text with converted text
        function replaceOriginalText() {
            const convertedText = document.getElementById('converted-text').textContent;
            document.getElementById('textInput').value = convertedText;
            
            // Re-analyze the new text
            setTimeout(() => {
                analyzeText();
            }, 500);
            
            alert('Original text replaced with converted version!');
        }
        
        // Clear text
        function clearText() {
            document.getElementById('textInput').value = '';
            document.getElementById('detection-results').style.display = 'none';
            document.getElementById('explanation-content').style.display = 'none';
            document.getElementById('patterns-content').style.display = 'none';
            document.getElementById('style-results').style.display = 'none';
            document.getElementById('no-analysis').style.display = 'block';
            document.getElementById('conversion-results').style.display = 'none';
            
            // Also clear selected file
            clearSelectedFile();
            
            // Reset button texts
            const buttons = [
                document.getElementById('conversion-btn-main'),
                document.getElementById('conversion-btn-style')
            ];
            
            buttons.forEach(button => {
                if (button) {
                    button.innerHTML = '<i class="fas fa-magic"></i> Apply Recommended Conversion';
                    button.removeAttribute('data-direction');
                }
            });
        }
    </script>
</body>
</html>